<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tree with d3-mitch-tree</title>
    <script src="https://cdn.jsdelivr.net/gh/deltoss/d3-mitch-tree@1.0.2/dist/js/d3-mitch-tree.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/gh/deltoss/d3-mitch-tree@1.0.2/dist/css/d3-mitch-tree.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/gh/deltoss/d3-mitch-tree@1.0.2/dist/css/d3-mitch-tree-theme-default.min.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="./styles.css" rel="stylesheet" type="text/css" />
  </head>
  </head>
  <body>
    <nav class="navbar bg-custom">
      <div class="container-fluid">
        <a class="navbar-brand text-white" href="#">
          <img src="/assets/image/vital-icon.png" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
          <span class="h3">VitalMagnet</span>
        </a>
      </div>
    </nav>
    <h4 class="mt-4">Usar el comando: Vital mover a "Nombre del nodo"</h4>

    <button id="startButton" class="btn bg-custom text-white" type="button">Iniciar comandos de vos</button>
    <section
      id="visualisation"
      class="border w-50 mx-auto mt-2"
    ></section>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="./index.js"></script>
    <script type="module">
      function getData() {
        var data = {
          id: 1,
          idTag: "iniciar",
          name: "Iniciar",
          type: "Root",
          description: "Biodescodificacion vertebras",
          children: [
            {
              id: 2,
              idTag: "vertebras",
              name: "VÃ©rtebras",
              type: "Type",
              description: "Hay alguna alteracion en vertebras",
              children: [
                {
                  id: 3,
                  idTag: "cervicales",
                  name: "Cervicales",
                  type: "Type",
                  description: "Existe Desequilibrio",
                  children: [
                    {
                      id: 4,
                      idTag: "cervical-1",
                      name: "Cervical 1",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 5,
                      idTag: "cervical-2",
                      name: "Cervical 2",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 6,
                      idTag: "cervical-3",
                      name: "Cervical 3",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                  ],
                },
                {
                  id: 7,
                  idTag: "dorsales",
                  name: "Dorsales",
                  type: "Type",
                  description: "Existe Desequilibrio",
                  children: [
                    {
                      id: 8,
                      idTag: "dorsales-1",
                      name: "Dorsales 1",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 9,
                      idTag: "dorsales-2",
                      name: "Dorsales 2",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 10,
                      idTag: "dorsales-3",
                      name: "Dorsales 3",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                  ],
                },
                {
                  id: 11,
                  idTag: "lumbares",
                  name: "Lumbares",
                  type: "Type",
                  description: "Existe Desequilibrio",
                  children: [
                    {
                      id: 12,
                      idTag: "lumbares-1",
                      name: "Lumbares 1",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 13,
                      idTag: "lumbares-2",
                      name: "Lumbares 2",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 14,
                      idTag: "lumbares-3",
                      name: "Lumbares 3",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                  ],
                },
                {
                  id: 15,
                  idTag: "sacro",
                  name: "Sacro",
                  type: "Type",
                  description: "Existe Desequilibrio",
                  children: [
                    {
                      id: 16,
                      idTag: "sacro-1",
                      name: "Sacro 1",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                    {
                      id: 17,
                      idTag: "sacro-2",
                      name: "Sacro 2",
                      type: "Type",
                      description: "Existe Desequilibrio",
                    },
                  ],
                },
                {
                  id: 18,
                  idTag: "coxis",
                  name: "Coxis",
                  type: "Type",
                  description: "Existe Desequilibrio",
                },
              ],
            },
          ],
        };

        return data;
      }

      //Drawing the tree's nodes

      var data = getData();

      var treePlugin = new d3.mitchTree.boxedTree()
        .setData(data)
        .setElement(document.getElementById("visualisation"))
        .setIdAccessor(function (data) {
          return data.id;
        })
        .setChildrenAccessor(function (data) {
          return data.children;
        })
        .setBodyDisplayTextAccessor(function (data) {
          return data.description;
        })
        .setTitleDisplayTextAccessor(function (data) {
          return data.name;
        })
        .initialize();

      function updateTreeClasses(treePlugin) {
        treePlugin
          .getPanningContainer()
          .selectAll("g.node")
          .attr("id", function (data, index, arr) {
            return data.data.idTag;
          });
      }

      treePlugin.update = function (nodeDataItem) {
        this.__proto__.update.call(this, nodeDataItem);
        updateTreeClasses(this);
      };

      updateTreeClasses(treePlugin);
    </script>
  </body>
</html>
